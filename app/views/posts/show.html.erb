<h3>Add a comment</h3>

<% if @comment&.errors&.any? %>
  <div>
    <h4>Could not save comment:</h4>
    <ul>
      <% @comment.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<%= form_with url: post_comments_path(@post), model: [@post, @comment || Comment.new] do |f| %>
  <div>
    <%= f.text_area :body, placeholder: "Write a comment..." %>
  </div>

  <%= f.submit "Comment" %>
<% end %>

<h3>Comments</h3>

<% @post.comments.each do |comment| %>
  <div>
    <strong><%= comment.user.email %>:</strong>
    <%= comment.body %>

    <% if comment.user == current_user %>
      <%= button_to "Delete",
        post_comment_path(@post, comment),
        method: :delete,
        data: { turbo_confirm: "Delete this comment?" } %>
    <% end %>
  </div>
<% end %>
