<div>
  <h1>Discover Users</h1>

  <% @users.each do |user| %>
    <div style="border: 1px solid #ddd; padding: 0.5rem; margin-bottom: 0.5rem;">
      <strong><%= user.email %></strong>

      <% if current_user.following?(user) %>
        <%= button_to "Unfollow",
          follow_path(current_user.sent_follows.find_by(followed: user)),
          method: :delete %>
      
      <% elsif current_user.requested_follow?(user) %>
        <em>Follow request sent</em>
      
      <% else %>
        <%= button_to "Follow",
          follows_path(followed_id: user.id),
          method: :post %>
      <% end %>
    </div>
  <% end %>
